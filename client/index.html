<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
    <button onclick="submitHandler()">Add session</button>
    <button onclick="getAllSessions()">Get all sessions</button>


    <input type="text" id="machine-id"><button onclick="getSessionsByMachine()">Get sessions by machine_id</button>

    <div class="queue-container">
        <div class="queue-item">
            <p>Alex Petrov | PRUSA MK3S | 120min | 1 year</p>
        </div>
    </div>

    <script type="text/javascript">

        const SERVER_URL = "http://127.0.0.1:8000";

        let queueDiv = document.querySelector(".queue-container");
        let user = {
                filename: "test.gcode",
                duration: 120,
                machine_id: 2,
                user_id: 1,
                start: Date.now()
        }

        const submitHandler = (e) => {
            fetch(`${SERVER_URL}/add-session-related`, 
            {
                method: 'POST',
                headers: {'Content-Type': 'application/json'}, 
                body: JSON.stringify(user)
            })
            .then(response => response.json())
            .then(data => {
                console.log(data)
            });  
        }

        const getAllSessions = (e) => {
            fetch(`${SERVER_URL}/all`)
            .then(response => response.json())
            .then(data => {
                console.log(data);

                for (let item of data) {
                    let queueItem = document.createElement('div');
                    queueItem.setAttribute('class', 'queue-item');
                    queueItem.textContent = `${item.username} | ${item.filename} | ${item.duration} | ${item.machine_id}`;
                    queueDiv.appendChild(queueItem);
                }
            }); 
        }

        const getSessionsByMachine = (e) => {
            const machineId = document.querySelector("#machine-id").value;
            fetch(`${SERVER_URL}/select-by-machine/${machineId}`)
            .then(response => response.json())
            .then(data => {
                console.log(data);
            })
        }

    </script>
</body>
</html>